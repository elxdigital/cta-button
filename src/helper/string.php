<?php

function string_slug(string $raw_string): string
{
    $pre_formated_string = mb_strtolower(html_entity_decode($raw_string));

    $formats = [
        "À" => "a",
        "Á" => "a",
        "Â" => "a",
        "Ã" => "a",
        "Ä" => "a",
        "Å" => "a",
        "Æ" => "a",
        "Ç" => "c",
        "È" => "e",
        "É" => "e",
        "Ê" => "e",
        "Ë" => "e",
        "Ì" => "i",
        "Í" => "i",
        "Î" => "i",
        "Ï" => "i",
        "Ð" => "d",
        "Ñ" => "n",
        "Ò" => "o",
        "Ó" => "o",
        "Ô" => "o",
        "Õ" => "o",
        "Ö" => "o",
        "Ø" => "o",
        "Ù" => "u",
        "Ú" => "u",
        "Û" => "u",
        "Ü" => "u",
        "ü" => "u",
        "Ý" => "y",
        "Þ" => "p",
        "ß" => "b",
        "à" => "a",
        "á" => "a",
        "â" => "a",
        "ã" => "a",
        "ä" => "a",
        "å" => "a",
        "æ" => "a",
        "ç" => "c",
        "è" => "e",
        "é" => "e",
        "ê" => "e",
        "ë" => "e",
        "ì" => "i",
        "í" => "i",
        "î" => "i",
        "ï" => "i",
        "ð" => "o",
        "ñ" => "n",
        "ò" => "o",
        "ó" => "o",
        "ô" => "o",
        "õ" => "o",
        "ö" => "o",
        "ø" => "o",
        "ù" => "u",
        "ú" => "u",
        "û" => "u",
        "ý" => "y",
        "ý" => "y",
        "þ" => "b",
        "ÿ" => "y",
        "R" => "r",
        "r" => "r",
        '"' => " ",
        "!" => " ",
        "@" => " ",
        "#" => " ",
        "$" => " ",
        "%" => " ",
        "&" => " ",
        "*" => " ",
        "(" => " ",
        ")" => " ",
        "_" => " ",
        "-" => " ",
        "+" => " ",
        "=" => " ",
        "{" => " ",
        "[" => " ",
        "}" => " ",
        "]" => " ",
        "/" => " ",
        "?" => " ",
        ";" => " ",
        ":" => " ",
        "." => " ",
        "," => " ",
        "\\" => " ",
        "\\" => " ",
        "\\" => " ",
        "\n" => " ",
        "'" => " ",
        "<" => " ",
        ">" => " ",
        "°" => " ",
        "º" => " ",
        "ª" => " ",
    ];

    $slug = str_replace(
        ["-----", "----", "---", "--"],
        "-",
        str_replace(
            " ",
            "-",
            trim(strtr($pre_formated_string, $formats))
        )
    );

    return $slug;
}
